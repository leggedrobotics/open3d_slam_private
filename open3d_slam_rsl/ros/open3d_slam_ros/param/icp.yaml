# See https://github.com/anybotics/libpointmatcher/blob/master/doc/Datafilters.md

readingDataPointsFilters:
#  - RandomSamplingDataPointsFilter:
#      prob: 0.35
#  - SimpleSensorNoiseDataPointsFilter:
#       gain: 2

referenceDataPointsFilters:
#  - RandomSamplingDataPointsFilter:
#      prob: 0.25
#  - SamplingSurfaceNormalDataPointsFilter:
#      knn: 10
#      ratio: 0.666666
#      samplingMethod: 1
#      averageExistingDescriptors: 0

matcher:
  KDTreeMatcher:
    knn: 1              # 1
    maxDist: 0.5        # 0.5
    epsilon: 0.01       # 0.01

outlierFilters:
#  - RobustOutlierFilter:
#      robustFct: huber   # huber, cauchy, tukey, welsch, sc
#      scaleEstimator: std    #std, mad, berg
#      tuning: 1.375      # 1.375
  - TrimmedDistOutlierFilter:
     ratio: 0.70         # 0.9
  - SurfaceNormalOutlierFilter:
     maxAngle: 0.57   # 1.57 == 90 deg,  0.57 == 30 deg
#  - MaxDistOutlierFilter:
#     maxDist: 1.0

degeneracyDebug:
  Enabled: # "Enabled" or "Disabled

printingDegeneracy:
  Enabled: # "Enabled" or "Disabled

regularization:
  Disabled: # "Enabled" or "Disabled

ceresDegeneracyAnalysis:
  CeresDegeneracyState:
    isActive: 0 # "Enabled" or "Disabled
    useSophusParametrization: 0
    useSophusAutoDiffParametrization: 0
    useAngleAxisParametrization: 1 # by default enabled
    usePointToPointCost: 0
    usePointToLineCost: 0
    usePointToPlaneCost: 1 # by default enabled
    useSymmetricPointToPlaneCost: 0
    useBoundConstraints: 1 # needs the detection either from SolRemap or xicp
    useSixDofRegularization: 1 #YOU HAVE TO USE IN COMBINATION WITH SOLUTION REMAPPING
    useThreeDofRegularization: 0 #YOU HAVE TO USE IN COMBINATION WITH X-ICP
    regularizationWeight: 500.0 # you need to set  .0  as double

degeneracyAwareness:
  SolutionRemapping:
    threshold: 80
    use2019: 0
  #EqualityConstraints:
  #  highInformationThreshold: 350   ##  STANDALONE 1650
  #  enoughInformationThreshold: 150  #  850
  #  insufficientInformationThreshold: 40 # 450
  #  point2NormalMinimalAlignmentAngleThreshold: 80 # 17 sept was 80 when was 70 it crashed 
  #  point2NormalStrongAlignmentAngleThreshold: 45
  #SolutionRemapping:
  #  threshold: 120
  #  use2019: 0
  #OptimizedEqualityConstraints:
  #  enoughInformationThreshold: 250   #new 250  300
  #  insufficientInformationThreshold: 180  #new 180 150
  #  point2NormalMinimalAlignmentAngleThreshold: 80
  #  point2NormalStrongAlignmentAngleThreshold: 45
  #InequalityConstraints:
  #  highInformationThreshold: 350   ##       RUMLANG GICIK     
  #  enoughInformationThreshold: 180  # was 150 17 sept when was 250 it crasahed. investigate
  #  insufficientInformationThreshold: 45   ### RUMLANG GICIK  30
  #  point2NormalMinimalAlignmentAngleThreshold: 60 # OUSTER 60  
  #  point2NormalStrongAlignmentAngleThreshold: 45
  #  inequalityboundmultiplier: 8

  #None:

transformationCheckers:
  - DifferentialTransformationChecker:
      minDiffRotErr: 0.001    # 0.001
      minDiffTransErr: 0.01   # 0.01
      smoothLength: 3         # 3
  - CounterTransformationChecker:
      maxIterationCount: 30   # 30 
#  - BoundTransformationChecker:
#      maxRotationNorm: 0.80
#      maxTranslationNorm: 5.0
#  - BoundTransformationChecker:
#      maxRotationNorm: 0.26
#      maxTranslationNorm: 0.25

inspector:
#  VTKFileInspector
  NullInspector

logger:
#  FileLogger
  NullLogger

errorMinimizer:
  PointToPlaneErrorMinimizer
#  PointToPlaneWithCovErrorMinimizer